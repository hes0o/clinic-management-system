<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:HealthCenter.Desktop.ViewModels"
        xmlns:entities="using:HealthCenter.Desktop.Database.Entities"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="700"
        x:Class="HealthCenter.Desktop.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="HealthCenter - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØµØ­ÙŠ"
        Width="1200" Height="700"
        WindowStartupLocation="CenterScreen"
        FlowDirection="RightToLeft">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Styles>
        <Style Selector="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI, Arial"/>
        </Style>
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="#2563EB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        <Style Selector="Button.success">
            <Setter Property="Background" Value="#16A34A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,10"/>
        </Style>
        <Style Selector="Button.danger">
            <Setter Property="Background" Value="#DC2626"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,10"/>
        </Style>
        <Style Selector="TextBox">
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
        </Style>
        <Style Selector="Border.card">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="BoxShadow" Value="0 1 3 0 #1a000000"/>
        </Style>
        <Style Selector="Border.stat-card">
            <Setter Property="Background" Value="#F0FDF4"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="16"/>
        </Style>
    </Window.Styles>

    <Grid Background="#F3F4F6">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0" Background="#1E293B" Padding="0">
            <StackPanel Spacing="4">
                <!-- Logo -->
                <Border Padding="20" Background="#0F172A">
                    <StackPanel Spacing="8">
                        <TextBlock Text="ðŸ¥" FontSize="32" HorizontalAlignment="Center"/>
                        <TextBlock Text="HealthCenter" 
                                   FontSize="20" 
                                   FontWeight="Bold" 
                                   Foreground="White"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØµØ­ÙŠ" 
                                   FontSize="12" 
                                   Foreground="#94A3B8"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Navigation -->
                <StackPanel Margin="12,20,12,0" Spacing="4">
                    <Button Command="{Binding NavigateToCommand}" 
                            CommandParameter="Reception"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Right"
                            Background="#334155"
                            Foreground="White"
                            Padding="16,12"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„"/>
                            <TextBlock Text="ðŸ¨"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding NavigateToCommand}" 
                            CommandParameter="Queue"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Right"
                            Background="Transparent"
                            Foreground="#94A3B8"
                            Padding="16,12"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±"/>
                            <TextBlock Text="ðŸ“º"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding NavigateToCommand}" 
                            CommandParameter="Doctor"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Right"
                            Background="Transparent"
                            Foreground="#94A3B8"
                            Padding="16,12"
                            CornerRadius="8">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨"/>
                            <TextBlock Text="ðŸ‘¨â€âš•ï¸"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Stats at bottom -->
                <StackPanel Margin="12,40,12,0" Spacing="12">
                    <Border Background="#334155" CornerRadius="8" Padding="12">
                        <StackPanel>
                            <TextBlock Text="Ù…Ø±Ø¶Ù‰ Ø§Ù„ÙŠÙˆÙ…" Foreground="#94A3B8" FontSize="12"/>
                            <TextBlock Text="{Binding TodayPatientCount}" 
                                       Foreground="White" 
                                       FontSize="28" 
                                       FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#334155" CornerRadius="8" Padding="12">
                        <StackPanel>
                            <TextBlock Text="ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±" Foreground="#94A3B8" FontSize="12"/>
                            <TextBlock Text="{Binding WaitingCount}" 
                                       Foreground="#FBBF24" 
                                       FontSize="28" 
                                       FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Column="1" Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="0,0,0,24">
                <TextBlock Text="Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø±Ø¶Ù‰" 
                           FontSize="28" 
                           FontWeight="Bold"
                           Foreground="#1E293B"/>
                <TextBlock Text="Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø© Ø§Ù†ØªØ¸Ø§Ø±" 
                           FontSize="14" 
                           Foreground="#64748B"/>
            </StackPanel>

            <!-- Content Grid -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="350"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Patient List -->
                <Border Grid.Column="0" Classes="card" Margin="0,0,16,0">
                    <Grid RowDefinitions="Auto,Auto,*">
                        <!-- Search -->
                        <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,16">
                            <TextBox Grid.Column="0"
                                     Text="{Binding SearchQuery}"
                                     Watermark="ðŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ..."
                                     Margin="0,0,8,0"/>
                            <Button Grid.Column="1" 
                                    Classes="primary"
                                    Command="{Binding SearchPatientsCommand}"
                                    Content="Ø¨Ø­Ø«"/>
                        </Grid>

                        <!-- Column Headers -->
                        <Grid Grid.Row="1" Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Ø§Ù„Ø§Ø³Ù…" FontWeight="SemiBold" Foreground="#64748B"/>
                            <TextBlock Grid.Column="1" Text="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" FontWeight="SemiBold" Foreground="#64748B"/>
                            <TextBlock Grid.Column="2" Text="Ø§Ù„ØªØ§Ø±ÙŠØ®" FontWeight="SemiBold" Foreground="#64748B"/>
                        </Grid>

                        <!-- Patient List -->
                        <ListBox Grid.Row="2" 
                                 ItemsSource="{Binding Patients}"
                                 SelectedItem="{Binding SelectedPatient}"
                                 Background="Transparent"
                                 BorderThickness="0">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="entities:Patient">
                                    <Grid Margin="0,8" ColumnDefinitions="*,150,120">
                                        <TextBlock Grid.Column="0" 
                                                   Text="{Binding FullName}" 
                                                   FontWeight="Medium"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" 
                                                   Text="{Binding PhoneNumber}"
                                                   Foreground="#64748B"
                                                   VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" 
                                                   Text="{Binding CreatedAt, StringFormat='{}{0:MM/dd}'}"
                                                   Foreground="#94A3B8"
                                                   VerticalAlignment="Center"/>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Grid>
                </Border>

                <!-- Right: Actions Panel -->
                <StackPanel Grid.Column="1" Spacing="16">
                    <!-- Add New Patient -->
                    <Border Classes="card">
                        <StackPanel Spacing="16">
                            <TextBlock Text="âž• Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯" 
                                       FontSize="16" 
                                       FontWeight="SemiBold"/>
                            
                            <StackPanel Spacing="8">
                                <TextBlock Text="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" Foreground="#64748B"/>
                                <TextBox Text="{Binding NewPatientName}" 
                                         Watermark="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶"/>
                            </StackPanel>

                            <StackPanel Spacing="8">
                                <TextBlock Text="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" Foreground="#64748B"/>
                                <TextBox Text="{Binding NewPatientPhone}" 
                                         Watermark="05xxxxxxxx"/>
                            </StackPanel>

                            <Button Classes="success"
                                    Command="{Binding AddPatientCommand}"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="ðŸ’¾"/>
                                    <TextBlock Text="Ø­ÙØ¸ Ø§Ù„Ù…Ø±ÙŠØ¶"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>

                    <!-- Generate Ticket -->
                    <Border Classes="card">
                        <StackPanel Spacing="16">
                            <TextBlock Text="ðŸŽ« Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø© Ø§Ù†ØªØ¸Ø§Ø±" 
                                       FontSize="16" 
                                       FontWeight="SemiBold"/>
                            
                            <TextBlock Text="Ø§Ø®ØªØ± Ù…Ø±ÙŠØ¶ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø±" 
                                       Foreground="#64748B"
                                       TextWrapping="Wrap"/>

                            <Border Background="#FEF3C7" 
                                    CornerRadius="8" 
                                    Padding="12"
                                    IsVisible="{Binding SelectedPatient, Converter={x:Static ObjectConverters.IsNotNull}}">
                                <TextBlock Text="{Binding SelectedPatient.FullName}"
                                           FontWeight="SemiBold"
                                           Foreground="#92400E"/>
                            </Border>

                            <Button Classes="primary"
                                    Command="{Binding GenerateTicketCommand}"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    IsEnabled="{Binding SelectedPatient, Converter={x:Static ObjectConverters.IsNotNull}}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="ðŸŽŸï¸"/>
                                    <TextBlock Text="Ø¥Ù†Ø´Ø§Ø¡ ØªØ°ÙƒØ±Ø©"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Window>
